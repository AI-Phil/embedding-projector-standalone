<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Astra DB Helper</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 2em;
        }
        label {
            display: block;
            margin-top: 1em;
        }
        input[type="text"],
        input[type="password"] {
            width: 300px;
            padding: 0.5em;
            margin-top: 0.2em;
        }
        button {
            padding: 0.7em 1.5em;
            margin-top: 1em;
            cursor: pointer;
        }
        .hidden {
            display: none;
        }
        #results,
        #error {
            margin-top: 1em;
            padding: 1em;
            border: 1px solid #ccc;
        }
        #error {
            border-color: red;
            color: red;
        }
        #collections-list,
        #sample-data {
            margin-top: 0.5em;
        }
        pre {
            background-color: #f4f4f4;
            padding: 1em;
            border: 1px solid #ddd;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Astra DB Connection & Sampling Helper</h1>

    <section id="connection-section">
        <h2>1. Connect to Astra DB</h2>
        <form id="connection-form">
            <div>
                <label for="db_name">Connection Nickname:</label>
                <input type="text" id="db_name" name="db_name" placeholder="e.g., my-dev-db (used as namespace/keyspace)" required>
            </div>
            <div>
                <label for="endpoint_url">Astra Data API Endpoint URL:</label>
                <input type="text" id="endpoint_url" name="endpoint_url" placeholder="https://<db-id>-<region>.apps.astra.datastax.com/api/json/v1" required>
            </div>
            <div>
                <label for="token">Astra Application Token:</label>
                <input type="password" id="token" name="token" placeholder="AstraCS:..." required>
            </div>
            <button type="submit">Connect & List Collections</button>
        </form>
    </section>

    <section id="collections-section" class="hidden">
        <h2>2. Select Collection</h2>
        <div id="collections-list">
            <!-- Collection list will be populated here -->
        </div>
        <button id="sample-button" disabled>Get Sample Data (10 Docs)</button>
    </section>

    <section id="sampling-section" class="hidden">
        <h2>3. Sample Data</h2>
        <div id="sample-data">
            <pre><code><!-- Sample data will be shown here --></code></pre>
        </div>
        <button id="generate-config-button" disabled>Generate Projector Config</button>
    </section>

    <section id="config-section" class="hidden">
        <h2>4. Generated Configuration</h2>
        <p>Save the following content into files (`config.json`, `data.json`) in your projector directory:</p>
        <div>
            <label for="config-json">config.json:</label>
            <textarea id="config-json" rows="10" cols="80" readonly></textarea>
        </div>
        <div>
            <label for="data-json">data.json (Sample Data):</label>
            <textarea id="data-json" rows="10" cols="80" readonly></textarea>
        </div>
    </section>

    <hr>
    <div id="results">Status: Waiting for connection details...</div>
    <div id="error" class="hidden"></div>

    <script src="/static/js/astra_helper.js" defer></script>

</body>
</html>